# Atlas Editor - Render Deployment Guide

## üöÄ **Render Configuration**

### **1. Database Setup (PostgreSQL)**

**Service Type:** PostgreSQL
**Name:** `atlas-editor-db`
**Database:** `atlas_editor`
**User:** `atlas_user` (or auto-generated)
**Password:** Auto-generated by Render

**Connection String Format:**
```
postgresql://atlas_user:password@dpg-xxxxx-a.oregon-postgres.render.com:5432/atlas_editor
```

### **2. Web Service Setup**

**Service Type:** Web Service
**Name:** `atlas-editor-api`
**Environment:** Node
**Build Command:** `npm install`
**Start Command:** `npm start`
**Port:** 3001

### **3. Frontend Setup (Optional)**

**Service Type:** Static Site
**Name:** `atlas-editor-frontend`
**Build Command:** `cd app && npm install && npm run build`
**Publish Directory:** `app/dist`

## üîß **Environment Variables for Render**

### **Web Service Environment Variables:**

```env
# Slack API Configuration
SLACK_BOT_TOKEN=xoxb-your-bot-token-here
SLACK_CLIENT_ID=your-slack-client-id
SLACK_CLIENT_SECRET=your-slack-client-secret
SLACK_REDIRECT_URI=https://atlas-editor-api.onrender.com/auth/slack/callback

# Database Configuration (from Render PostgreSQL)
DATABASE_URL=postgresql://atlas_user:password@dpg-xxxxx-a.oregon-postgres.render.com:5432/atlas_editor

# Session Configuration
SESSION_SECRET=your-super-secure-session-secret-here

# Server Configuration
PORT=3001
NODE_ENV=production
FRONTEND_URL=https://atlas-editor-frontend.onrender.com

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Cache Configuration
CACHE_TTL_SECONDS=300
```

## üìã **Step-by-Step Render Deployment**

### **Step 1: Create PostgreSQL Database**

1. Go to [render.com](https://render.com) and sign in
2. Click **"New +"** ‚Üí **"PostgreSQL"**
3. **Name:** `atlas-editor-db`
4. **Database:** `atlas_editor`
5. **User:** `atlas_user`
6. **Region:** Choose closest to your users
7. Click **"Create Database"**
8. **Copy the connection string** (you'll need this)

### **Step 2: Create Web Service**

1. Click **"New +"** ‚Üí **"Web Service"**
2. **Connect your GitHub repository** (push Atlas Editor to GitHub first)
3. **Name:** `atlas-editor-api`
4. **Environment:** `Node`
5. **Build Command:** `npm install`
6. **Start Command:** `npm start`
7. **Port:** `3001`

### **Step 3: Configure Environment Variables**

In the Render web service dashboard, add these environment variables:

```env
SLACK_BOT_TOKEN=xoxb-your-bot-token-here
SLACK_CLIENT_ID=your-slack-client-id
SLACK_CLIENT_SECRET=your-slack-client-secret
SLACK_REDIRECT_URI=https://atlas-editor-api.onrender.com/auth/slack/callback
DATABASE_URL=postgresql://atlas_user:password@dpg-xxxxx-a.oregon-postgres.render.com:5432/atlas_editor
SESSION_SECRET=your-super-secure-session-secret-here
PORT=3001
NODE_ENV=production
FRONTEND_URL=https://atlas-editor-frontend.onrender.com
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
CACHE_TTL_SECONDS=300
```

### **Step 4: Update Slack App Manifest**

Update your Slack app manifest with the Render URLs:

```json
{
  "oauth_config": {
    "redirect_urls": [
      "https://atlas-editor-api.onrender.com/auth/slack/callback",
      "http://localhost:3001/auth/slack/callback"
    ]
  }
}
```

### **Step 5: Deploy Frontend (Optional)**

1. Click **"New +"** ‚Üí **"Static Site"**
2. **Connect your GitHub repository**
3. **Name:** `atlas-editor-frontend`
4. **Build Command:** `cd app && npm install && npm run build`
5. **Publish Directory:** `app/dist`
6. **Environment Variables:**
   ```env
   VITE_API_URL=https://atlas-editor-api.onrender.com
   ```

## üîß **Required Code Updates for Render**

### **1. Update package.json**

Add production start script:

```json
{
  "scripts": {
    "start": "node api/server.js",
    "dev": "concurrently \"npm run dev:api\" \"npm run dev:app\"",
    "dev:api": "nodemon api/server.js",
    "dev:app": "cd app && npm run dev",
    "build": "cd app && npm run build",
    "setup": "npm install && cd app && npm install"
  }
}
```

### **2. Update Frontend API URL**

Update `app/src/App.jsx`:

```javascript
// API configuration
const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';
```

### **3. Add Render-specific Configuration**

Create `render.yaml` for easy deployment:

```yaml
services:
  - type: web
    name: atlas-editor-api
    env: node
    buildCommand: npm install
    startCommand: npm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3001

  - type: pserv
    name: atlas-editor-db
    env: postgresql
    databaseName: atlas_editor
    user: atlas_user

  - type: web
    name: atlas-editor-frontend
    env: static
    buildCommand: cd app && npm install && npm run build
    staticPublishPath: app/dist
    envVars:
      - key: VITE_API_URL
        value: https://atlas-editor-api.onrender.com
```

## üåê **Render URLs**

After deployment, your services will be available at:

- **API:** `https://atlas-editor-api.onrender.com`
- **Frontend:** `https://atlas-editor-frontend.onrender.com`
- **Database:** Internal connection string

## üîí **Security Considerations**

### **1. Environment Variables**
- Never commit `.env` files to GitHub
- Use Render's environment variable system
- Generate secure session secrets

### **2. Database Security**
- Render PostgreSQL is secure by default
- Connection strings are encrypted
- No public access to database

### **3. HTTPS**
- Render provides HTTPS by default
- Update Slack app with HTTPS URLs
- Use secure cookies

## üìä **Render Pricing**

### **Free Tier:**
- **Web Service:** 750 hours/month
- **PostgreSQL:** 1GB storage
- **Static Site:** Unlimited

### **Paid Plans:**
- **Starter:** $7/month per service
- **Standard:** $25/month per service
- **Pro:** $85/month per service

## üöÄ **Deployment Checklist**

- [ ] Push code to GitHub
- [ ] Create PostgreSQL database on Render
- [ ] Create web service on Render
- [ ] Configure environment variables
- [ ] Update Slack app with Render URLs
- [ ] Deploy and test
- [ ] Set up custom domain (optional)
- [ ] Configure SSL (automatic on Render)

## üéØ **Next Steps**

1. **Push your code to GitHub**
2. **Create Render account**
3. **Set up PostgreSQL database**
4. **Create web service**
5. **Configure environment variables**
6. **Update Slack app URLs**
7. **Deploy and test**

Render will handle all the infrastructure, scaling, and SSL certificates automatically!
